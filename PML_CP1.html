<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Panagiotis Pramangioulis" />

<meta name="date" content="2018-05-18" />

<title>Practical Machine Learning - Cource Project</title>

<script src="PML_CP1_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="PML_CP1_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="PML_CP1_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="PML_CP1_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="PML_CP1_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="PML_CP1_files/navigation-1.1/tabsets.js"></script>
<link href="PML_CP1_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="PML_CP1_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>


</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->






<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Practical Machine Learning - Cource Project</h1>
<h4 class="author"><em>Panagiotis Pramangioulis</em></h4>
<h4 class="date"><em>May 18, 2018</em></h4>

</div>


<div id="executive-summary" class="section level2">
<h2>1. Executive Summary</h2>
<p>Using devices such as Jawbone Up, Nike FuelBand, and Fitbit it is now possible to collect a large amount of data about personal activity relatively inexpensively. These type of devices are part of the quantified self movement - a group of enthusiasts who take measurements about themselves regularly to improve their health, to find patterns in their behavior, or because they are tech geeks. One thing that people regularly do is quantify how much of a particular activity they do, but they rarely quantify how well they do it. In this project, your goal will be to use data from accelerometers on the belt, forearm, arm, and dumbell of 6 participants. They were asked to perform barbell lifts correctly and incorrectly in 5 different ways. More information is available from the website <a href="http://web.archive.org/web/20161224072740/http:/groupware.les.inf.puc-rio.br/har">here</a>.</p>
<p>The goal of this project is to predict the manner in which they did the exercise. This is the “classe” variable in the training set. We used many of the other variables to predict with. Through this report the reader will find a description on how we built the model, how we used the cross validation to validate our model, information about the expected out of sample error, as well as why we made specific choices the choices. As a final step, we used our prediction model to predict 20 different test cases with the main purpose to check the robustness of the.</p>
</div>
<div id="exploring-and-preparing-the-data" class="section level2">
<h2>2. Exploring and Preparing the Data</h2>
<div id="data-loading-and-overview" class="section level3">
<h3>2.1 Data Loading and Overview</h3>
<p>The original dataset has been splitted already in <a href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv">“train”</a> and <a href="https://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv">“test”</a> set. The main source of the data is:</p>
<p><strong>Velloso, E.; Bulling, A.; Gellersen, H.; Ugulino, W.; Fuks, H. “Qualitative Activity Recognition of Weight Lifting Exercises. Proceedings of 4th International Conference in Cooperation with SIGCHI (Augmented Human ’13)”. Stuttgart, Germany: ACM SIGCHI, 2013</strong></p>
<p>Description of the data:</p>
<p>“Six young health participants were asked to perform one set of 10 repetitions of the Unilateral Dumbbell Biceps Curl in five different fashions: exactly according to the specification (Class A), throwing the elbows to the front (Class B), lifting the dumbbell only halfway (Class C), lowering the dumbbell only halfway (Class D) and throwing the hips to the front (Class E).</p>
<p>Class A corresponds to the specified execution of the exercise, while the other 4 classes correspond to common mistakes. Participants were supervised by an experienced weight lifter to make sure the execution complied to the manner they were supposed to simulate. The exercises were performed by six male participants aged between 20-28 years, with little weight lifting experience. We made sure that all participants could easily simulate the mistakes in a safe and controlled manner by using a relatively light dumbbell (1.25kg).&quot;</p>
<div id="loading-neccessary-libraries" class="section level4">
<h4>2.1.1 Loading Neccessary Libraries</h4>
<p>As a first step, we will load the necessary libraries that we will need to conduct the exploratory analysis and data cleaning as well as the final modelling. In addition, we will make sure that reproducibility of our result is secured by setting and appropriate seed</p>
<pre class="r"><code>library(caret)</code></pre>
<pre><code>## Warning: package &#39;caret&#39; was built under R version 3.4.4</code></pre>
<pre><code>## Loading required package: lattice</code></pre>
<pre><code>## Loading required package: ggplot2</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 3.4.4</code></pre>
<pre class="r"><code>library(randomForest)</code></pre>
<pre><code>## Warning: package &#39;randomForest&#39; was built under R version 3.4.4</code></pre>
<pre><code>## randomForest 4.6-14</code></pre>
<pre><code>## Type rfNews() to see new features/changes/bug fixes.</code></pre>
<pre><code>## 
## Attaching package: &#39;randomForest&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     margin</code></pre>
<pre class="r"><code>library(corrplot)</code></pre>
<pre><code>## Warning: package &#39;corrplot&#39; was built under R version 3.4.4</code></pre>
<pre><code>## corrplot 0.84 loaded</code></pre>
<pre class="r"><code>set.seed(161019) #for reproducibility</code></pre>
</div>
<div id="loading-the-data" class="section level4">
<h4>2.1.2 Loading the Data</h4>
<p>As a next step we will load the <em>training</em> and <em>testing datasets</em> from the provided URLs. In sequence, we will subset the <em>training</em> data into “train” (70% of the initial dataset) and “validation” (rest 30% of the initial dataset). The <em>testing</em> dataset will be used at the end of our analysis in order to predict the extra 20 cases.</p>
<pre class="r"><code>#Assigning the dataset URLs to a name
Url_training &lt;- &quot;http://d396qusza40orc.cloudfront.net/predmachlearn/pml-training.csv&quot;
Url_testing  &lt;- &quot;http://d396qusza40orc.cloudfront.net/predmachlearn/pml-testing.csv&quot;

#Reading the datasets from the URLs and assigning each to a name
training &lt;- read.csv(url(Url_training))
testing  &lt;- read.csv(url(Url_testing))

#Subsetting the training dataset in training and test subset
inTrain  &lt;- createDataPartition(training$classe, p=0.70, list=FALSE)
TrainSet &lt;- training[inTrain, ]
ValidSet  &lt;- training[-inTrain, ]

#To check what eacxh data contains
str(TrainSet)</code></pre>
<pre><code>## &#39;data.frame&#39;:    13737 obs. of  160 variables:
##  $ X                       : int  1 3 6 8 9 10 11 12 13 14 ...
##  $ user_name               : Factor w/ 6 levels &quot;adelmo&quot;,&quot;carlitos&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ raw_timestamp_part_1    : int  1323084231 1323084231 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 1323084232 ...
##  $ raw_timestamp_part_2    : int  788290 820366 304277 440390 484323 484434 500302 528316 560359 576390 ...
##  $ cvtd_timestamp          : Factor w/ 20 levels &quot;02/12/2011 13:32&quot;,..: 9 9 9 9 9 9 9 9 9 9 ...
##  $ new_window              : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ num_window              : int  11 11 12 12 12 12 12 12 12 12 ...
##  $ roll_belt               : num  1.41 1.42 1.45 1.42 1.43 1.45 1.45 1.43 1.42 1.42 ...
##  $ pitch_belt              : num  8.07 8.07 8.06 8.13 8.16 8.17 8.18 8.18 8.2 8.21 ...
##  $ yaw_belt                : num  -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 -94.4 ...
##  $ total_accel_belt        : int  3 3 3 3 3 3 3 3 3 3 ...
##  $ kurtosis_roll_belt      : Factor w/ 397 levels &quot;&quot;,&quot;-0.016850&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_picth_belt     : Factor w/ 317 levels &quot;&quot;,&quot;-0.021887&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_yaw_belt       : Factor w/ 2 levels &quot;&quot;,&quot;#DIV/0!&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_roll_belt      : Factor w/ 395 levels &quot;&quot;,&quot;-0.003095&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_roll_belt.1    : Factor w/ 338 levels &quot;&quot;,&quot;-0.005928&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_yaw_belt       : Factor w/ 2 levels &quot;&quot;,&quot;#DIV/0!&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ max_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_picth_belt          : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_yaw_belt            : Factor w/ 68 levels &quot;&quot;,&quot;-0.1&quot;,&quot;-0.2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ min_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_pitch_belt          : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_yaw_belt            : Factor w/ 68 levels &quot;&quot;,&quot;-0.1&quot;,&quot;-0.2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ amplitude_roll_belt     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ amplitude_pitch_belt    : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ amplitude_yaw_belt      : Factor w/ 4 levels &quot;&quot;,&quot;#DIV/0!&quot;,&quot;0.00&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ var_total_accel_belt    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_roll_belt        : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_pitch_belt          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_pitch_belt       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_pitch_belt          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_yaw_belt            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_yaw_belt         : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_yaw_belt            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ gyros_belt_x            : num  0 0 0.02 0.02 0.02 0.03 0.03 0.02 0.02 0.02 ...
##  $ gyros_belt_y            : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ gyros_belt_z            : num  -0.02 -0.02 -0.02 -0.02 -0.02 0 -0.02 -0.02 0 -0.02 ...
##  $ accel_belt_x            : int  -21 -20 -21 -22 -20 -21 -21 -22 -22 -22 ...
##  $ accel_belt_y            : int  4 5 4 4 2 4 2 2 4 4 ...
##  $ accel_belt_z            : int  22 23 21 21 24 22 23 23 21 21 ...
##  $ magnet_belt_x           : int  -3 -2 0 -2 1 -3 -5 -2 -3 -8 ...
##  $ magnet_belt_y           : int  599 600 603 603 602 609 596 602 606 598 ...
##  $ magnet_belt_z           : int  -313 -305 -312 -313 -312 -308 -317 -319 -309 -310 ...
##  $ roll_arm                : num  -128 -128 -128 -128 -128 -128 -128 -128 -128 -128 ...
##  $ pitch_arm               : num  22.5 22.5 22 21.8 21.7 21.6 21.5 21.5 21.4 21.4 ...
##  $ yaw_arm                 : num  -161 -161 -161 -161 -161 -161 -161 -161 -161 -161 ...
##  $ total_accel_arm         : int  34 34 34 34 34 34 34 34 34 34 ...
##  $ var_accel_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_roll_arm         : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_pitch_arm        : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_yaw_arm             : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_yaw_arm          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_yaw_arm             : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ gyros_arm_x             : num  0 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 0.02 ...
##  $ gyros_arm_y             : num  0 -0.02 -0.03 -0.02 -0.03 -0.03 -0.03 -0.03 -0.02 0 ...
##  $ gyros_arm_z             : num  -0.02 -0.02 0 0 -0.02 -0.02 0 0 -0.02 -0.03 ...
##  $ accel_arm_x             : int  -288 -289 -289 -289 -288 -288 -290 -288 -287 -288 ...
##  $ accel_arm_y             : int  109 110 111 111 109 110 110 111 111 111 ...
##  $ accel_arm_z             : int  -123 -126 -122 -124 -122 -124 -123 -123 -124 -124 ...
##  $ magnet_arm_x            : int  -368 -368 -369 -372 -369 -376 -366 -363 -372 -371 ...
##  $ magnet_arm_y            : int  337 344 342 338 341 334 339 343 338 331 ...
##  $ magnet_arm_z            : int  516 513 513 510 518 516 509 520 509 523 ...
##  $ kurtosis_roll_arm       : Factor w/ 330 levels &quot;&quot;,&quot;-0.02438&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_picth_arm      : Factor w/ 328 levels &quot;&quot;,&quot;-0.00484&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_yaw_arm        : Factor w/ 395 levels &quot;&quot;,&quot;-0.01548&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_roll_arm       : Factor w/ 331 levels &quot;&quot;,&quot;-0.00051&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_pitch_arm      : Factor w/ 328 levels &quot;&quot;,&quot;-0.00184&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_yaw_arm        : Factor w/ 395 levels &quot;&quot;,&quot;-0.00311&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ max_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_picth_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_yaw_arm             : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_yaw_arm             : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ amplitude_roll_arm      : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ amplitude_pitch_arm     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ amplitude_yaw_arm       : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ roll_dumbbell           : num  13.1 12.9 13.4 12.8 13.2 ...
##  $ pitch_dumbbell          : num  -70.5 -70.3 -70.8 -70.3 -70.4 ...
##  $ yaw_dumbbell            : num  -84.9 -85.1 -84.5 -85.1 -84.9 ...
##  $ kurtosis_roll_dumbbell  : Factor w/ 398 levels &quot;&quot;,&quot;-0.0035&quot;,&quot;-0.0073&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_picth_dumbbell : Factor w/ 401 levels &quot;&quot;,&quot;-0.0163&quot;,&quot;-0.0233&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_yaw_dumbbell   : Factor w/ 2 levels &quot;&quot;,&quot;#DIV/0!&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_roll_dumbbell  : Factor w/ 401 levels &quot;&quot;,&quot;-0.0082&quot;,&quot;-0.0096&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_pitch_dumbbell : Factor w/ 402 levels &quot;&quot;,&quot;-0.0053&quot;,&quot;-0.0084&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_yaw_dumbbell   : Factor w/ 2 levels &quot;&quot;,&quot;#DIV/0!&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ max_roll_dumbbell       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_picth_dumbbell      : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_yaw_dumbbell        : Factor w/ 73 levels &quot;&quot;,&quot;-0.1&quot;,&quot;-0.2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ min_roll_dumbbell       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_pitch_dumbbell      : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_yaw_dumbbell        : Factor w/ 73 levels &quot;&quot;,&quot;-0.1&quot;,&quot;-0.2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ amplitude_roll_dumbbell : num  NA NA NA NA NA NA NA NA NA NA ...
##   [list output truncated]</code></pre>
<pre class="r"><code>str(ValidSet)</code></pre>
<pre><code>## &#39;data.frame&#39;:    5885 obs. of  160 variables:
##  $ X                       : int  2 4 5 7 21 23 28 29 35 36 ...
##  $ user_name               : Factor w/ 6 levels &quot;adelmo&quot;,&quot;carlitos&quot;,..: 2 2 2 2 2 2 2 2 2 2 ...
##  $ raw_timestamp_part_1    : int  1323084231 1323084232 1323084232 1323084232 1323084232 1323084232 1323084233 1323084233 1323084233 1323084233 ...
##  $ raw_timestamp_part_2    : int  808298 120339 196328 368296 876301 932285 120363 136333 340386 412295 ...
##  $ cvtd_timestamp          : Factor w/ 20 levels &quot;02/12/2011 13:32&quot;,..: 9 9 9 9 9 9 9 9 9 9 ...
##  $ new_window              : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ num_window              : int  11 12 12 12 12 12 13 13 13 13 ...
##  $ roll_belt               : num  1.41 1.48 1.48 1.42 1.6 1.56 1.53 1.52 1.41 1.42 ...
##  $ pitch_belt              : num  8.07 8.05 8.07 8.09 8.1 8.1 8.14 8.16 8.18 8.12 ...
##  $ yaw_belt                : num  -94.4 -94.4 -94.4 -94.4 -94.4 -94.3 -94.4 -94.4 -94.4 -94.3 ...
##  $ total_accel_belt        : int  3 3 3 3 3 3 3 3 3 3 ...
##  $ kurtosis_roll_belt      : Factor w/ 397 levels &quot;&quot;,&quot;-0.016850&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_picth_belt     : Factor w/ 317 levels &quot;&quot;,&quot;-0.021887&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_yaw_belt       : Factor w/ 2 levels &quot;&quot;,&quot;#DIV/0!&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_roll_belt      : Factor w/ 395 levels &quot;&quot;,&quot;-0.003095&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_roll_belt.1    : Factor w/ 338 levels &quot;&quot;,&quot;-0.005928&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_yaw_belt       : Factor w/ 2 levels &quot;&quot;,&quot;#DIV/0!&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ max_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_picth_belt          : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_yaw_belt            : Factor w/ 68 levels &quot;&quot;,&quot;-0.1&quot;,&quot;-0.2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ min_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_pitch_belt          : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_yaw_belt            : Factor w/ 68 levels &quot;&quot;,&quot;-0.1&quot;,&quot;-0.2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ amplitude_roll_belt     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ amplitude_pitch_belt    : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ amplitude_yaw_belt      : Factor w/ 4 levels &quot;&quot;,&quot;#DIV/0!&quot;,&quot;0.00&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ var_total_accel_belt    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_roll_belt        : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_roll_belt           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_pitch_belt          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_pitch_belt       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_pitch_belt          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_yaw_belt            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_yaw_belt         : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_yaw_belt            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ gyros_belt_x            : num  0.02 0.02 0.02 0.02 0.02 0.02 0.03 0.03 0 0 ...
##  $ gyros_belt_y            : num  0 0 0.02 0 0 0 0 0 0 0 ...
##  $ gyros_belt_z            : num  -0.02 -0.03 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 -0.03 -0.02 ...
##  $ accel_belt_x            : int  -22 -22 -21 -22 -20 -21 -21 -20 -22 -21 ...
##  $ accel_belt_y            : int  4 3 2 3 1 4 3 4 4 3 ...
##  $ accel_belt_z            : int  22 21 24 21 20 21 21 23 22 21 ...
##  $ magnet_belt_x           : int  -7 -6 -6 -4 -10 -4 -4 -4 1 -3 ...
##  $ magnet_belt_y           : int  608 604 600 599 607 606 599 606 600 603 ...
##  $ magnet_belt_z           : int  -311 -310 -302 -311 -304 -311 -317 -320 -301 -319 ...
##  $ roll_arm                : num  -128 -128 -128 -128 -129 -129 -129 -129 -129 -130 ...
##  $ pitch_arm               : num  22.5 22.1 22.1 21.9 20.9 20.7 20.7 20.7 20.5 20.3 ...
##  $ yaw_arm                 : num  -161 -161 -161 -161 -161 -161 -161 -161 -161 -161 ...
##  $ total_accel_arm         : int  34 34 34 34 34 34 34 34 34 34 ...
##  $ var_accel_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_roll_arm         : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_pitch_arm        : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ avg_yaw_arm             : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ stddev_yaw_arm          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ var_yaw_arm             : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ gyros_arm_x             : num  0.02 0.02 0 0 0.03 0.02 -0.02 -0.02 0.02 0.03 ...
##  $ gyros_arm_y             : num  -0.02 -0.03 -0.03 -0.03 -0.02 -0.02 -0.02 -0.02 -0.02 -0.02 ...
##  $ gyros_arm_z             : num  -0.02 0.02 0 0 -0.02 -0.02 0 0 -0.02 -0.03 ...
##  $ accel_arm_x             : int  -290 -289 -289 -289 -288 -290 -290 -290 -290 -289 ...
##  $ accel_arm_y             : int  110 111 111 111 111 110 110 109 111 111 ...
##  $ accel_arm_z             : int  -125 -123 -123 -125 -124 -123 -126 -125 -124 -123 ...
##  $ magnet_arm_x            : int  -369 -372 -374 -373 -375 -373 -364 -367 -369 -368 ...
##  $ magnet_arm_y            : int  337 344 337 336 337 333 340 337 336 340 ...
##  $ magnet_arm_z            : int  513 512 506 509 513 509 532 514 514 515 ...
##  $ kurtosis_roll_arm       : Factor w/ 330 levels &quot;&quot;,&quot;-0.02438&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_picth_arm      : Factor w/ 328 levels &quot;&quot;,&quot;-0.00484&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_yaw_arm        : Factor w/ 395 levels &quot;&quot;,&quot;-0.01548&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_roll_arm       : Factor w/ 331 levels &quot;&quot;,&quot;-0.00051&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_pitch_arm      : Factor w/ 328 levels &quot;&quot;,&quot;-0.00184&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_yaw_arm        : Factor w/ 395 levels &quot;&quot;,&quot;-0.00311&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ max_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_picth_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_yaw_arm             : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_roll_arm            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_pitch_arm           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_yaw_arm             : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ amplitude_roll_arm      : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ amplitude_pitch_arm     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ amplitude_yaw_arm       : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ roll_dumbbell           : num  13.1 13.4 13.4 13.1 13.4 ...
##  $ pitch_dumbbell          : num  -70.6 -70.4 -70.4 -70.2 -70.8 ...
##  $ yaw_dumbbell            : num  -84.7 -84.9 -84.9 -85.1 -84.5 ...
##  $ kurtosis_roll_dumbbell  : Factor w/ 398 levels &quot;&quot;,&quot;-0.0035&quot;,&quot;-0.0073&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_picth_dumbbell : Factor w/ 401 levels &quot;&quot;,&quot;-0.0163&quot;,&quot;-0.0233&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ kurtosis_yaw_dumbbell   : Factor w/ 2 levels &quot;&quot;,&quot;#DIV/0!&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_roll_dumbbell  : Factor w/ 401 levels &quot;&quot;,&quot;-0.0082&quot;,&quot;-0.0096&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_pitch_dumbbell : Factor w/ 402 levels &quot;&quot;,&quot;-0.0053&quot;,&quot;-0.0084&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ skewness_yaw_dumbbell   : Factor w/ 2 levels &quot;&quot;,&quot;#DIV/0!&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ max_roll_dumbbell       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_picth_dumbbell      : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ max_yaw_dumbbell        : Factor w/ 73 levels &quot;&quot;,&quot;-0.1&quot;,&quot;-0.2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ min_roll_dumbbell       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_pitch_dumbbell      : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ min_yaw_dumbbell        : Factor w/ 73 levels &quot;&quot;,&quot;-0.1&quot;,&quot;-0.2&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ amplitude_roll_dumbbell : num  NA NA NA NA NA NA NA NA NA NA ...
##   [list output truncated]</code></pre>
</div>
<div id="cleaning-the-data" class="section level4">
<h4>2.1.3 Cleaning the Data</h4>
<p>Both train and test subsets are having enough observations to support a proper analysis; however, they both contain a lot of missing values as well as may be unnecesssary variables ( Near Zero Variance and identification variables). For this reason, it is rendered necessary to apply a proper data cleaning, by removing those variables which contain a lot missing values as well those that are not inofrmative for our analysis (Near Zero Variance variables).</p>
<pre class="r"><code>#Removing variables that are canditates for Nearly Zero Variance
NZV &lt;- nearZeroVar(TrainSet)
TrainSet &lt;- TrainSet[, -NZV]
ValidSet  &lt;- ValidSet[, -NZV]


#Removing variables that are having a lot of missing values
manyNAs    &lt;- sapply(TrainSet, function(x) mean(is.na(x))) &gt; 0.95
TrainSet &lt;- TrainSet[, manyNAs==FALSE]
ValidSet  &lt;- ValidSet[, manyNAs==FALSE]

#Removing Identification variables
TrainSet &lt;- TrainSet[, -(1:5)]
ValidSet  &lt;- ValidSet[, -(1:5)]
dim(TrainSet)</code></pre>
<pre><code>## [1] 13737    54</code></pre>
<pre class="r"><code>dim(ValidSet)</code></pre>
<pre><code>## [1] 5885   54</code></pre>
</div>
<div id="exploring-the-data" class="section level4">
<h4>2.1.4 Exploring the Data</h4>
<p>Before proceeding to our main analysis it is rendered necessary to identify whether there are dependencies existing between the variables. For this reason, we will conduct a multiple correlation analysis.</p>
<pre class="r"><code>corMatrix &lt;- cor(TrainSet[, -54])
corrplot(corMatrix, order = &quot;FPC&quot;, method = &quot;color&quot;, type = &quot;lower&quot;, 
         tl.cex = 0.8, tl.col = rgb(0, 0, 0))</code></pre>
<p><img src="PML_CP1_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>From the correlation plot above we can observe that there are a few pair of varibales which are showed to be quite significantly correlated (darker blue and darker red squares). At this pointed, it would necessary to denote that we could apply a “Dimension Reduction” technique (e.g. Principal Component Analysis or Factor Analysis) to reduce the process time of the machine learning algorithm on a later stage, but we choose to leave this part out of the scope of the specific analysis.</p>
</div>
</div>
</div>
<div id="main-analysis-predictive-modelling-machine-learning" class="section level2">
<h2>3. Main Analysis (Predictive Modelling/ Machine learning)</h2>
<p>Within this section we will apply the Random Forest on the “train” subset of the <em>training</em> dataset and later apply it on the “validation” suset to perform a cross Validation test, targeting to identify the prediction accuaracy of the applied random forest model. If the accuracy level is satisfying, we will proceed on applying the model to our <em>testing</em> dataset.</p>
<div id="training-the-random-forest-model" class="section level3">
<h3>3.1 Training the Random Forest model</h3>
<p>We train a model using random forest with a cross validation of 3 folds to avoid overfitting</p>
<pre class="r"><code>model_RF &lt;- train(classe ~., method=&quot;rf&quot;, data=TrainSet, trControl=trainControl(method=&#39;cv&#39;, number=3, verboseIter=FALSE))
model_RF$finalModel</code></pre>
<pre><code>## 
## Call:
##  randomForest(x = x, y = y, mtry = param$mtry) 
##                Type of random forest: classification
##                      Number of trees: 500
## No. of variables tried at each split: 27
## 
##         OOB estimate of  error rate: 0.25%
## Confusion matrix:
##      A    B    C    D    E  class.error
## A 3904    1    0    0    1 0.0005120328
## B    7 2648    2    1    0 0.0037622272
## C    0    5 2390    1    0 0.0025041736
## D    0    0    8 2243    1 0.0039964476
## E    0    1    0    7 2517 0.0031683168</code></pre>
</div>
<div id="cross-validating-the-random-forest-model" class="section level3">
<h3>3.2 Cross Validating the Random Forest Model</h3>
<p>In this section, we will apply the previously trained Random Forest model on the “validation” subset in order to check the accuracy of the prediction. Apart from the relative test metrics on thi smatter, we will produce proper visualization to show the accuracy of the trained random Forest model.</p>
<pre class="r"><code>#Cross Validtaion Test/ metrics
predictRF &lt;- predict(model_RF, newdata=ValidSet)
confMatRF &lt;- confusionMatrix(predictRF, ValidSet$classe)
confMatRF</code></pre>
<pre><code>## Confusion Matrix and Statistics
## 
##           Reference
## Prediction    A    B    C    D    E
##          A 1674    0    0    0    0
##          B    0 1139    2    0    0
##          C    0    0 1024    5    0
##          D    0    0    0  959    0
##          E    0    0    0    0 1082
## 
## Overall Statistics
##                                           
##                Accuracy : 0.9988          
##                  95% CI : (0.9976, 0.9995)
##     No Information Rate : 0.2845          
##     P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
##                                           
##                   Kappa : 0.9985          
##  Mcnemar&#39;s Test P-Value : NA              
## 
## Statistics by Class:
## 
##                      Class: A Class: B Class: C Class: D Class: E
## Sensitivity            1.0000   1.0000   0.9981   0.9948   1.0000
## Specificity            1.0000   0.9996   0.9990   1.0000   1.0000
## Pos Pred Value         1.0000   0.9982   0.9951   1.0000   1.0000
## Neg Pred Value         1.0000   1.0000   0.9996   0.9990   1.0000
## Prevalence             0.2845   0.1935   0.1743   0.1638   0.1839
## Detection Rate         0.2845   0.1935   0.1740   0.1630   0.1839
## Detection Prevalence   0.2845   0.1939   0.1749   0.1630   0.1839
## Balanced Accuracy      1.0000   0.9998   0.9985   0.9974   1.0000</code></pre>
<pre class="r"><code>#Cross Validation Visualization
plot(confMatRF$table, col = confMatRF$byClass, 
     main = paste(&quot;Random Forest - Accuracy =&quot;,
                  round(confMatRF$overall[&#39;Accuracy&#39;], 4)))</code></pre>
<p><img src="PML_CP1_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>From the graph above, we can observe that the trained model provides as with an high level accuracy (99.6%), while the estinated out-of-sample error is 0.4%. Based on this result, we can proceed on applying the trained and now validated model on the <em>testing</em> set.</p>
</div>
<div id="applying-the-trained-and-validated-model-on-the-test-data" class="section level3">
<h3>3.3 Applying the Trained and Validated Model on the Test data</h3>
<p>In this section we will apply the Random Forest model to predict the 20 quiz results (testing dataset) as shown below.</p>
<pre class="r"><code>pred_RF_final &lt;- predict(model_RF, newdata=testing)
pred_RF_final</code></pre>
<pre><code>##  [1] B A B A A E D B A A B C B A E E A B B B
## Levels: A B C D E</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
